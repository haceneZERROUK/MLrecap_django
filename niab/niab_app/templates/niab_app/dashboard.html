{% extends 'niab_app/base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- Statistiques hebdomadaires -->
    <div class="bg-white p-6 rounded-lg shadow">
        <h2 class="text-xl font-bold mb-4 text-[#292E1E]">Statistiques de la semaine</h2>
        {% if weekly_stats %}
        <div class="grid grid-cols-2 gap-4">
            <div class="p-4 bg-[#7F95D1] text-white rounded">
                <p class="text-sm">Revenus</p>
                <p class="text-2xl">{{ weekly_stats.revenue }}€</p>
            </div>
            <div class="p-4 bg-[#BC8034] text-white rounded">
                <p class="text-sm">Bénéfices</p>
                <p class="text-2xl">{{ weekly_stats.profit }}€</p>
            </div>
            <div class="p-4 bg-[#A63446] text-white rounded">
                <p class="text-sm">Taux d'occupation</p>
                <p class="text-2xl">{{ weekly_stats.occupancy_rate }}%</p>
            </div>
        </div>
        {% else %}
        <p>Aucune donnée disponible pour cette semaine</p>
        {% endif %}
    </div>

    <!-- Films en cours de projection -->
    <div class="bg-white p-6 rounded-lg shadow">
        <h2 class="text-xl font-bold mb-4 text-[#292E1E]">Films en cours</h2>
        {% for screening in current_screenings %}
        <div class="mb-4 p-4 border rounded">
            <h3 class="font-bold">{{ screening.film.titre_fr }}</h3>
            <p>Salle {{ screening.numero_salle }}</p>
            <p>Entrées estimées: {{ screening.audience_quotidienne_estimee }}</p>
        </div>
        {% empty %}
        <p>Aucun film en cours de projection</p>
        {% endfor %}
    </div>

    <!-- Prochaines sorties -->
    <div class="col-span-1 md:col-span-2 bg-white p-6 rounded-lg shadow">
        <h2 class="text-xl font-bold mb-4 text-[#292E1E]">Prochaines sorties</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for movie in upcoming_movies %}
            <div class="border p-4 rounded hover:shadow-lg transition-shadow">
                <h3 class="font-bold">{{ movie.titre_fr }}</h3>
                <p class="text-sm text-gray-600">Sortie le {{ movie.date|date:"d/m/Y" }}</p>
                <p>Entrées prévues: {{ movie.entrees_prevues|default:"Non calculé" }}</p>
                <a href="{% url 'film_detail' movie.pk %}" 
                   class="mt-2 inline-block bg-[#7F95D1] text-white px-4 py-2 rounded">
                    Détails
                </a>
            </div>
            {% empty %}
            <p>Aucune sortie prévue</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}